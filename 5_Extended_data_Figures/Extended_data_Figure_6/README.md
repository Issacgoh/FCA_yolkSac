# Extended_data_Figure_6

This directory contains code for the approaches used to generate figures and analyses used in Extended_data_Figure_6 of our manuscript. 

### 1_v2_YS_IPSC_mac_lin_A1_V7_IG_logist_general_060321_low_dim_regression.ipynb
Code used to generate: Median logistic regression class prediction probabilities for a model trained on YS scRNA-seq myeloid cell states (x-axis) to predict equivalent cell states in iPSC scRNA-seq data (y-axis) with a probability threshold of 0.7. ‘Monocyte1’ and ‘monocyte2’ are grouped together into the ‘monocyte’ category (Supplementary Tables 20, 21).

### 2_overall_DEGS_plots.ipynb
Code used to generate: Dot plot showing the level (colour scale) and percent expression (dot size) of myeloid lineage gene markers in YS scRNA-seq dataset (top) and iPSC-derived scRNA-seq dataset (bottom) dataset (Supplementary Table 12).

### 3_iPSC_macrophage_trajectories.ipynb
Code used to generate: Density plots showing the distribution of transitioning IPSC-derived Macrophage lineage cells from <D21 (n= 5 k=779)(top) >D21 (n=7 k=8553)(bottom) in the integrated FDG landscape..Colour of cells represents the z-scored kernel density estimation (KDE) score for each timepoint (Supplementary Table 20).

### 4_Extended_figure_6e_AR.ipynb
Code used to generate: 
Heatmap showing the level (colour scale) and percent expression (dot size) of differentially expressed genes (DEGs) generated by Milo for early vs late YS macrophages. Grouped by linked functions. Data log-normalised and scaled zero_center=True, vmax=1, vmin=-1.

### 5_Extended_figure_6f
Code used to generate: Mean logistic regression class prediction probabilities for a model trained on YS scRNA-seq myeloid cell states projected onto cells with classification probability threshold of 0.7 to predict macrophages and microglia/TREM2 macrophages in external fetal brain22 and fetal skin17 datasets(vmax=1, vmin=-1). 

### 6_microglia_cellphonedb_dotplot.ipynb
Code used to generate: Heatmap visualisation of CellphoneDB predicted interactions between microglia-like and endothelial cell states in the YS scRNA-seq (Supplementary Table 18). Colour scale represents z-scored mean expression values of each gene pair.
